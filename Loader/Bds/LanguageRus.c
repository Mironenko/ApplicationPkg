/** @file

  Copyright (c) 2008 - 2011, Intel Corporation. All rights reserved.<BR>
  This program and the accompanying materials
  are licensed and made available under the terms and conditions of the BSD License
  which accompanies this distribution.  The full text of the license may be found at
  http://opensource.org/licenses/bsd-license.php

  THE PROGRAM IS DISTRIBUTED UNDER THE BSD LICENSE ON AN "AS IS" BASIS,
  WITHOUT WARRANTIES OR REPRESENTATIONS OF ANY KIND, EITHER EXPRESS OR IMPLIED.

**/

#include "Language.h"

EFI_GUID mFontRusPackageGuid = {
  0x67b43f12, 0xf139, 0x43a6, {0x98, 0x4b, 0x6c, 0xa6, 0x66, 0x90, 0xbb, 0x49}
};


EFI_NARROW_GLYPH  gRusNarrowGlyphData[] = {
  //
  { 0x0401, 0x00, {0x00,0x6C,0x00,0xFE,0x66,0x62,0x60,0x68,0x78,0x68,0x60,0x60,0x62,0x66,0xFE,0x00,0x00,0x00,0x00}},  // ¨

  { 0x0410, 0x00, {0x00,0x00,0x00,0x10,0x38,0x6C,0xC6,0xC6,0xC6,0xFE,0xC6,0xC6,0xC6,0xC6,0xC6,0x00,0x00,0x00,0x00}},  // À
  { 0x0411, 0x00, {0x00,0x00,0x00,0xFE,0x66,0x62,0x60,0x60,0x7C,0x66,0x66,0x66,0x66,0x66,0xFC,0x00,0x00,0x00,0x00}},  // Á
  { 0x0412, 0x00, {0x00,0x00,0x00,0xFC,0x66,0x66,0x66,0x66,0x7C,0x66,0x66,0x66,0x66,0x66,0xFC,0x00,0x00,0x00,0x00}},  // Â
  { 0x0413, 0x00, {0x00,0x00,0x00,0xFE,0x66,0x62,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0xF0,0x00,0x00,0x00,0x00}},  // Ã
  { 0x0414, 0x00, {0x00,0x00,0x00,0x3C,0x6C,0x6C,0x6C,0x6C,0x6C,0x6C,0x6C,0x6C,0x6C,0x6C,0xFE,0xC6,0xC6,0x00,0x00}},  // Ä
  { 0x0415, 0x00, {0x00,0x00,0x00,0xFE,0x66,0x62,0x60,0x68,0x78,0x68,0x60,0x60,0x62,0x66,0xFE,0x00,0x00,0x00,0x00}},  // Å
  { 0x0416, 0x00, {0x00,0x00,0x00,0xD6,0xD6,0xD6,0xD6,0x7C,0x38,0x7C,0xD6,0xD6,0xD6,0xD6,0xD6,0x00,0x00,0x00,0x00}},  // Æ
  { 0x0417, 0x00, {0x00,0x00,0x00,0x7C,0xC6,0x06,0x06,0x06,0x3C,0x06,0x06,0x06,0xC6,0xC6,0x7C,0x00,0x00,0x00,0x00}},  // Ç
  { 0x0418, 0x00, {0x00,0x00,0x00,0xC6,0xC6,0xC6,0xCE,0xDE,0xFE,0xF6,0xE6,0xC6,0xC6,0xC6,0xC6,0x00,0x00,0x00,0x00}},  // È
  { 0x0419, 0x00, {0x00,0x28,0x38,0xC6,0xC6,0xC6,0xCE,0xDE,0xFE,0xF6,0xE6,0xC6,0xC6,0xC6,0xC6,0x00,0x00,0x00,0x00}},  // É
  { 0x041a, 0x00, {0x00,0x00,0x00,0xE6,0x66,0x66,0x6C,0x6C,0x78,0x6C,0x6C,0x66,0x66,0x66,0xE6,0x00,0x00,0x00,0x00}},  // Ê
  { 0x041b, 0x00, {0x00,0x00,0x00,0x3E,0x66,0x66,0x66,0x66,0x66,0x66,0x66,0x66,0x66,0x66,0xE6,0x00,0x00,0x00,0x00}},  // Ë
  { 0x041c, 0x00, {0x00,0x00,0x00,0x82,0xC6,0xEE,0xFE,0xFE,0xD6,0xC6,0xC6,0xC6,0xC6,0xC6,0xC6,0x00,0x00,0x00,0x00}},  // Ì
  { 0x041d, 0x00, {0x00,0x00,0x00,0xC6,0xC6,0xC6,0xC6,0xC6,0xFE,0xC6,0xC6,0xC6,0xC6,0xC6,0xC6,0x00,0x00,0x00,0x00}},  // Í
  { 0x041e, 0x00, {0x00,0x00,0x00,0x7C,0xC6,0xC6,0xC6,0xC6,0xC6,0xC6,0xC6,0xC6,0xC6,0xC6,0x7C,0x00,0x00,0x00,0x00}},  // Î
  { 0x041f, 0x00, {0x00,0x00,0x00,0xFE,0xC6,0xC6,0xC6,0xC6,0xC6,0xC6,0xC6,0xC6,0xC6,0xC6,0xC6,0x00,0x00,0x00,0x00}},  // Ï
  { 0x0420, 0x00, {0x00,0x00,0x00,0xFC,0x66,0x66,0x66,0x66,0x66,0x7C,0x60,0x60,0x60,0x60,0xF0,0x00,0x00,0x00,0x00}},  // Ð
  { 0x0421, 0x00, {0x00,0x00,0x00,0x3C,0x66,0xC2,0xC0,0xC0,0xC0,0xC0,0xC0,0xC0,0xC2,0x66,0x3C,0x00,0x00,0x00,0x00}},  // Ñ
  { 0x0422, 0x00, {0x00,0x00,0x00,0xFC,0xFC,0xB4,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x78,0x00,0x00,0x00,0x00}},  // Ò
  { 0x0423, 0x00, {0x00,0x00,0x00,0xC6,0xC6,0xC6,0xC6,0xC6,0x7E,0x06,0x06,0x06,0xC6,0xC6,0x7C,0x00,0x00,0x00,0x00}},  // Ó
  { 0x0424, 0x00, {0x00,0x00,0x00,0x10,0x7C,0xD6,0xD6,0xD6,0xD6,0xD6,0xD6,0xD6,0xD6,0x7C,0x10,0x00,0x00,0x00,0x00}},  // Ô
  { 0x0425, 0x00, {0x00,0x00,0x00,0xC6,0xC6,0xC6,0x6C,0x6C,0x38,0x6C,0x6C,0xC6,0xC6,0xC6,0xC6,0x00,0x00,0x00,0x00}},  // Õ
  { 0x0426, 0x00, {0x00,0x00,0x00,0xCC,0xCC,0xCC,0xCC,0xCC,0xCC,0xCC,0xCC,0xCC,0xCC,0xCC,0xFE,0x06,0x06,0x00,0x00}},  // Ö
  { 0x0427, 0x00, {0x00,0x00,0x00,0xC6,0xC6,0xC6,0xC6,0xC6,0xC6,0x7E,0x06,0x06,0x06,0x06,0x06,0x00,0x00,0x00,0x00}},  // ×
  { 0x0428, 0x00, {0x00,0x00,0x00,0xD6,0xD6,0xD6,0xD6,0xD6,0xD6,0xD6,0xD6,0xD6,0xD6,0xD6,0xFE,0x00,0x00,0x00,0x00}},  // Ø
  { 0x0429, 0x00, {0x00,0x00,0x00,0xD6,0xD6,0xD6,0xD6,0xD6,0xD6,0xD6,0xD6,0xD6,0xD6,0xD6,0xFE,0x03,0x03,0x00,0x00}},  // Ù
  { 0x042a, 0x00, {0x00,0x00,0x00,0xF8,0xF0,0xB0,0x30,0x30,0x3C,0x36,0x36,0x36,0x36,0x36,0x7C,0x00,0x00,0x00,0x00}},  // Ú
  { 0x042b, 0x00, {0x00,0x00,0x00,0xC6,0xC6,0xC6,0xC6,0xC6,0xF6,0xDA,0xDA,0xDA,0xDA,0xDA,0xF6,0x00,0x00,0x00,0x00}},  // Û
  { 0x042c, 0x00, {0x00,0x00,0x00,0xF0,0x60,0x60,0x60,0x60,0x7C,0x66,0x66,0x66,0x66,0x66,0xFC,0x00,0x00,0x00,0x00}},  // Ü
  { 0x042d, 0x00, {0x00,0x00,0x00,0x78,0xCC,0x06,0x06,0x26,0x3E,0x26,0x06,0x06,0x86,0xCC,0x78,0x00,0x00,0x00,0x00}},  // Ý
  { 0x042e, 0x00, {0x00,0x00,0x00,0xCE,0xDB,0xDB,0xDB,0xDB,0xFB,0xDB,0xDB,0xDB,0xDB,0xDB,0xCE,0x00,0x00,0x00,0x00}},  // Þ
  { 0x042f, 0x00, {0x00,0x00,0x00,0x7E,0xCC,0xCC,0xCC,0xCC,0xCC,0x7C,0x6C,0xCC,0xCC,0xCC,0xCE,0x00,0x00,0x00,0x00}},  // ß

  { 0x0430, 0x00, {0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x78,0x0C,0x0C,0x7C,0xCC,0xCC,0xCC,0x76,0x00,0x00,0x00,0x00}},  // à
  { 0x0431, 0x00, {0x00,0x00,0x00,0x00,0x06,0x1C,0x30,0x60,0x7C,0x66,0x66,0x66,0x66,0x66,0x3C,0x00,0x00,0x00,0x00}},  // á
  { 0x0432, 0x00, {0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xFC,0x66,0x66,0x7C,0x66,0x66,0x66,0xFC,0x00,0x00,0x00,0x00}},  // â
  { 0x0433, 0x00, {0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xFE,0x62,0x60,0x60,0x60,0x60,0x60,0xF0,0x00,0x00,0x00,0x00}},  // ã
  { 0x0434, 0x00, {0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x3C,0x6C,0x6C,0x6C,0x6C,0x6C,0x6C,0xFE,0xC6,0xC6,0x00,0x00}},  // ä
  { 0x0435, 0x00, {0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x7C,0xC6,0xC6,0xFE,0xC0,0xC0,0xC6,0x7C,0x00,0x00,0x00,0x00}},  // å
  { 0x0436, 0x00, {0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xD6,0xD6,0xD6,0x7C,0xD6,0xD6,0xD6,0xD6,0x00,0x00,0x00,0x00}},  // æ
  { 0x0437, 0x00, {0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x3C,0x66,0x06,0x0C,0x06,0x06,0x66,0x3C,0x00,0x00,0x00,0x00}},  // ç
  { 0x0438, 0x00, {0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xC6,0xC6,0xCE,0xDE,0xF6,0xE6,0xC6,0xC6,0x00,0x00,0x00,0x00}},  // è
  { 0x0439, 0x00, {0x00,0x00,0x00,0x00,0x28,0x38,0x00,0xC6,0xC6,0xCE,0xDE,0xF6,0xE6,0xC6,0xC6,0x00,0x00,0x00,0x00}},  // é
  { 0x043a, 0x00, {0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xE6,0x66,0x66,0x6C,0x78,0x6C,0x66,0xE6,0x00,0x00,0x00,0x00}},  // ê
  { 0x043b, 0x00, {0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x3E,0x66,0x66,0x66,0x66,0x66,0x66,0xE6,0x00,0x00,0x00,0x00}},  // ë
  { 0x043c, 0x00, {0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xC6,0xEE,0xFE,0xFE,0xD6,0xC6,0xC6,0xC6,0x00,0x00,0x00,0x00}},  // ì
  { 0x043d, 0x00, {0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xC6,0xC6,0xC6,0xFE,0xC6,0xC6,0xC6,0xC6,0x00,0x00,0x00,0x00}},  // í
  { 0x043e, 0x00, {0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x7C,0xC6,0xC6,0xC6,0xC6,0xC6,0xC6,0x7C,0x00,0x00,0x00,0x00}},  // î
  { 0x043f, 0x00, {0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xFE,0xC6,0xC6,0xC6,0xC6,0xC6,0xC6,0xC6,0x00,0x00,0x00,0x00}},  // ï
  { 0x0440, 0x00, {0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xDC,0x66,0x66,0x66,0x66,0x66,0x7C,0x60,0x60,0xF0,0x00,0x00}},  // ð
  { 0x0441, 0x00, {0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x7C,0xC6,0xC0,0xC0,0xC0,0xC0,0xC6,0x7C,0x00,0x00,0x00,0x00}},  // ñ
  { 0x0442, 0x00, {0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x7E,0x5A,0x18,0x18,0x18,0x18,0x18,0x3C,0x00,0x00,0x00,0x00}},  // ò
  { 0x0443, 0x00, {0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xC6,0xC6,0xC6,0xC6,0xC6,0xC6,0x7E,0x06,0x0C,0x78,0x00,0x00}},  // ó
  { 0x0444, 0x00, {0x00,0x00,0x00,0x00,0x00,0x10,0x10,0x7C,0xD6,0xD6,0xD6,0xD6,0xD6,0xD6,0x7C,0x10,0x10,0x00,0x00}},  // ô
  { 0x0445, 0x00, {0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xC6,0xC6,0x6C,0x38,0x6C,0xC6,0xC6,0xC6,0x00,0x00,0x00,0x00}},  // õ
  { 0x0446, 0x00, {0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xCC,0xCC,0xCC,0xCC,0xCC,0xCC,0xCC,0xFE,0x06,0x06,0x00,0x00}},  // ö
  { 0x0447, 0x00, {0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xC6,0xC6,0xC6,0xC6,0x7E,0x06,0x06,0x06,0x00,0x00,0x00,0x00}},  // ÷
  { 0x0448, 0x00, {0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xD6,0xD6,0xD6,0xD6,0xD6,0xD6,0xD6,0xFE,0x00,0x00,0x00,0x00}},  // ø
  { 0x0449, 0x00, {0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xD6,0xD6,0xD6,0xD6,0xD6,0xD6,0xD6,0xFE,0x03,0x03,0x00,0x00}},  // ù
  { 0x044a, 0x00, {0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xF8,0xB0,0x3C,0x36,0x36,0x36,0x36,0x7C,0x00,0x00,0x00,0x00}},  // ú
  { 0x044b, 0x00, {0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xC6,0xC6,0xF6,0xDA,0xDA,0xDA,0xDA,0xF6,0x00,0x00,0x00,0x00}},  // û
  { 0x044c, 0x00, {0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xF0,0x60,0x60,0x7C,0x66,0x66,0x66,0xFC,0x00,0x00,0x00,0x00}},  // ü
  { 0x044d, 0x00, {0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x3C,0x66,0x06,0x1E,0x06,0x06,0x66,0x3C,0x00,0x00,0x00,0x00}},  // ý
  { 0x044e, 0x00, {0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xCE,0xDB,0xDB,0xFB,0xFB,0xDB,0xDB,0xCE,0x00,0x00,0x00,0x00}},  // þ
  { 0x044f, 0x00, {0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x7E,0xCC,0xCC,0xCC,0x7C,0x6C,0xCC,0xCE,0x00,0x00,0x00,0x00}},  // ÿ

  { 0x0451, 0x00, {0x00,0x00,0x00,0x00,0x00,0x6C,0x00,0x7C,0xC6,0xC6,0xFE,0xC0,0xC0,0xC6,0x7C,0x00,0x00,0x00,0x00}},  // ¸

  { 0x0000, 0x00, {0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00}} //EOL
};

// Get available Unicode glyphs narrow fonts(8*19 pixels) size.
UINT32 mRusNarrowFontSize =  sizeof (gRusNarrowGlyphData);

//------------------------------------------------------------------------------
/*! \brief Install Rus Font package to the HII database */
//------------------------------------------------------------------------------
VOID
EFIAPI
InstallRusLanguage (
  IN  EFI_EVENT       Event,
  IN  VOID            *Context
)
{
  EFI_STATUS                           Status;
  EFI_HII_SIMPLE_FONT_PACKAGE_HDR      *SimplifiedFont;
  UINT32                               PackageLength;
  UINT8                                *Package;
  UINT8                                *Location;
  EFI_HII_DATABASE_PROTOCOL            *HiiDatabase;
  EFI_HII_HANDLE                       mHiiHandle;

  DEBUG((EFI_D_ERROR, "%a.%d\n", __FUNCTION__, __LINE__));

  //
  // Locate HII Database Protocol
  //
  Status = gBS->LocateProtocol (
                  &gEfiHiiDatabaseProtocolGuid,
                  NULL,
                  (VOID **) &HiiDatabase
                  );
  ASSERT_EFI_ERROR (Status);

  //
  // Add 4 bytes to the header for entire length for HiiAddPackages use only.
  //
  //    +--------------------------------+ <-- Package
  //    |                                |
  //    |    PackageLength(4 bytes)      |
  //    |                                |
  //    |--------------------------------| <-- SimplifiedFont
  //    |                                |
  //    |EFI_HII_SIMPLE_FONT_PACKAGE_HDR |
  //    |                                |
  //    |--------------------------------| <-- Location
  //    |                                |
  //    |     gUsStdNarrowGlyphData      |
  //    |                                |
  //    +--------------------------------+

  PackageLength   = sizeof (EFI_HII_SIMPLE_FONT_PACKAGE_HDR) + mRusNarrowFontSize + 4;
  Package = AllocateZeroPool (PackageLength);
  ASSERT (Package != NULL);

  WriteUnaligned32((UINT32 *) Package,PackageLength);
  SimplifiedFont = (EFI_HII_SIMPLE_FONT_PACKAGE_HDR *) (Package + 4);
  SimplifiedFont->Header.Length        = (UINT32) (PackageLength - 4);
  SimplifiedFont->Header.Type          = EFI_HII_PACKAGE_SIMPLE_FONTS;
  SimplifiedFont->NumberOfNarrowGlyphs = (UINT16) (mRusNarrowFontSize / sizeof (EFI_NARROW_GLYPH));

  Location = (UINT8 *) (&SimplifiedFont->NumberOfWideGlyphs + 1);
  CopyMem (Location, gRusNarrowGlyphData, mRusNarrowFontSize);

  //
  // Add this simplified font package to a package list then install it.
  //
  mHiiHandle = HiiAddPackages (
                 &mFontRusPackageGuid,
                 mBdsImageHandle,
                 Package,
                 NULL
                 );
  ASSERT (mHiiHandle != NULL);
  FreePool (Package);
}
//------------------------------------------------------------------------------


